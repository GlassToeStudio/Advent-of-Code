from computer import Computer

with open('input17', 'r') as data:
    data = list(map(int, data.read().split(',')))


tape = Computer(int_code=data)
tape.compute()
video = ''.join(map(chr, tape.out))
print(video)

video = video.splitlines()
sum_ = 0
for y, (top, mid, bot) in enumerate(zip(video, video[1:], video[2:]), start=1):
    for x, (top_,(mid1, mid2, mid3), bot_) in enumerate(zip(top[1:],
                                                            zip(mid, mid[1:], mid[2:]),
                                                            bot[1:]), start=1):
        if top_ == mid1 == mid2 == mid3 == bot_ == '#':
            sum_ += (x + 1) * (y + 1)

print(sum_) # Part 1

"""
......................................BBBBBBB......
......................................B.....B......
......................................B.....B......
......................................B.....B......
......................................B.....B......
......................................B.....B......
......................................B.....B......
......................................B.....B......
..............CCCCCCCCC.........BBBBBBB.....B......
......................C.........A...........B......
......................C.........A.........AA#AAAAAC
......................C.........A.........A.B.....C
......................C.........A.....AAAAAAA.....C
......................C.........A.....A...A.......C
......................CCCCCCCCCC#CA...A...A.......C
................................A.A...A...A.......C
BBBBBBBBBBBB^...................AAAAAAAAA.A.......C
B.................................A...A.A.A.......C
B.................AAAAAAA.........A...AAAAA.CCCCCCC
B.................A.....A.........A.....A...C......
B...............AAAAA...A.........AAAAAAA...C......
B...............A.A.A...A...................C......
BBBBBBBBB.......A.AAAAAAAAA.................C......
........B.......A...A...A.A.................C......
........B.......A...A...AC#CCCCCCCCCC.......C......
........B.......A...A.....A.........C.......C......
........B.....AAAAAAA.....A.........C.......C......
........B.....B.A.........A.........C.......C......
........BAAAAA#AA.........A.........C.......C......
..............B...........A.........C.......C2.....
..............B.....BBBBBBB.........CCCCCCCCC......
..............B.....B..............................
..............B.....B..............................
..............B.....B..............................
..............B.....B..............................
..............B.....B..............................
..............B.....B..............................
..............B.....B..............................
..............BBBBBBB..............................
"""

'B,A,B,A,C,C,A,B,A,C\n' # Main
'L,8,L,8,R,4,R,6,R,6\n' # A
'L,12,L,6,L,8,R,6\n' # B
'L,12,R,6,L,8\n' # C

tape.int_code[0] = 2
functions = 'B,A,B,A,C,C,A,B,A,C\nL,8,L,8,R,4,R,6,R,6\nL,12,L,6,L,8,R,6\nL,12,R,6,L,8\nn\n'
tape.compute_n(1, feed=map(ord, functions))
print(tape.out.popleft()) # Part 2